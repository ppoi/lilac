<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html" charset="UTF-8">
		<title>API Test(Read Record)</title>
	</head>
	<body>
		<h1>Reading Record API</h1>
		<h2 id="list">List</h2>
		<div>
			<form id="list-form">
				<label for="list-bibliographyId">書誌情報ID</label><input type="number" id="list-bibliographyId" /><br />
				<label>読了日</label><input type="date" id="list-completionDateBegin" />～<input type="date" id="list-completionDateEnd" /><br />
				<label for="list-incomplete">未読のみ</label><input type="checkbox" id="list-incomplete" /><br />
				<label for="list-page">ページ</label><input type="number" id="list-page" value="0" />
				<button id="execute-list">実行</button>
				<div id="list-result">
					<textarea rows="12" cols="60"></textarea>
				</div>
			</form>
		</div>
		<hr />
		<h2 id="get">Get</h2>
		<div>
			<form id="get-form">
				<input type="text" id="get-recordId" size="24" /><button id="execute-get">取得</button>
				<div id="get-result">
					<textarea rows="12" cols="60"></textarea>
				</div>
			</form>
		</div>
		<hr />
		<h2 id="create">Create</h2>
		<div>
			<form id="create-form">
				<textarea id="create-data" rows="12" cols="60"></textarea><br />
				<button id="execute-create">実行</button>
				<div id="create-result">
					<textarea rows="12" cols="60"></textarea>
				</div>
			</form>
		</div>
		<hr />
		<h2 id="update">Update</h2>
		<div>
			<form id="update-form">
				<textarea id="update-data" rows="12" cols="60"></textarea><br />
				<label for="update-recordId">ID</label><input type="number" id="update-recordId" size="24" /><button id="execute-update">実行</button>
				<div id="update-result">
					<textarea rows="12" cols="60"></textarea>
				</div>
			</form>
		</div>
		<hr />
		<h2 id="delete">Delete</h2>
		<div>
			<form id="delete-form">
				<input type="number" id="delete-recordId" size="24" /><button id="execute-delete">実行</button>
				<div id="delete-result">
					<textarea rows="12" cols="60"></textarea>
				</div>
			</form>
		</div>
		<script type="text/javascript" src="js/lib/jquery-1.7.1.min.js"></script>
		<script type="text/javascript">
			function showErrorMsg(jqXHR, textStatus, errorThrown) {
				alert(textStatus + ":" + errorThrown);
			}

			function setCondition(condition, key, prefix) {
				var value = $(prefix + "-" + key).val();
				if(value) {
					condition[key] = value;
				}
			}

			$("#list-form").submit(function(event) {
				event.preventDefault();
				var condition = {};
				var value;
				(value = $('#list-bibliographyId').val()) && (condition.bibliographyId = value);
				(value = $('#list-completionDateBegin').val()) && (condition.completionDateBegin = value);
				(value = $('#list-completionDateEnd').val()) && (condition.completionDateEnd = value);
				(value = $('#list-incomplete:checked').val()) && (condition.incomplete = true);
				$.ajax("/api/reading-record/list/" + $('#list-page').val(), {
					dataType: 'json',
					data: condition,
					type: 'GET'
				}).done(function(data, textStatus, jqXHR) {
					$("#list-result textarea").val(JSON.stringify(data));
				}).fail(showErrorMsg);
				return false;
			});

			$("#get-form").submit(function(event) {
				event.preventDefault();
				$.ajax("/api/reading-record/" + $("#get-recordId").val(), {
					dataType: 'json',
					type: 'GET'
				}).done(function(data, textStatus, jqXHR) {
					$("#get-result textarea").val(JSON.stringify(data));
				}).fail(showErrorMsg);
				return false;
			});

			$("#create-form").submit(function(event) {
				event.preventDefault();
				$.ajax("/api/reading-record", {
					contentType: 'application/json',
					dataType: 'json',
					data: $('#create-data').val(),
					type: 'PUT'
				}).done(function(data, textStatus, jqXHR) {
					$("#create-result textarea").val(JSON.stringify(data));
				}).fail(showErrorMsg);
				return false;
			});

			$("#update-form").submit(function(event) {
				event.preventDefault();
				$.ajax("/api/reading-record/" + $('#update-recordId').val(), {
					contentType: 'application/json',
					dataType: 'json',
					data: $('#update-data').val(),
					type: 'POST'
				}).done(function(data, textStatus, jqXHR) {
					$("#update-result textarea").val(JSON.stringify(data));
				}).fail(showErrorMsg);
				return false;
			});

			$("#delete-form").submit(function(event) {
				event.preventDefault();
				$.ajax("/api/reading-record/" + $("#delete-recordId").val(), {
					dataType: 'json',
					type: 'DELETE'
				}).done(function(data, textStatus, jqXHR) {
					$("#delete-result textarea").val(JSON.stringify(data));
				}).fail(showErrorMsg);
				return false;
			});
		</script>
	</body>
</html>